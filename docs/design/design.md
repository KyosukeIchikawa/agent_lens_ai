# 設計書: 論文解説ウェブサイト AgentLens: AI

## サイト構造設計

### 全体構成

論文解説サイトは以下の構成で設計されています：

#### 1. メインページ構成

- **ホームページ** (`/`): サイト概要と各論文の解説ページへのリンクや検索システム
- **論文一覧ページ** (`/papers/`): 掲載している全論文の一覧とプレビュー
- **個別論文ページ** (`/papers/[paperId]/`): 特定の論文のトップページ

#### 2. 論文コンテンツ構成

各論文のトップページと解説ページ

- 各論文のトップページは, その論文の全体の概要と重要ポイントをまとめた導入ページとする（論文のabstractに対応）
- 論文のセクションごとに解説を1ページ設ける（複数のサブセクションは1ページにまとめる）
- 原則として論文に明確に書かれている事のみを解説する
  - 論文のセクションごとに、そのセクションで説明されている事のみを解説する
- 必要に応じて読者の理解を助ける「AI Tips」を追加する
  - AI Tipsは読者の理解を助ける事を重視し、論文に明確に書かれていない解説、例え話、推測をする
  - AI Tipsは論文に書かれている内容ではない事を強調するため、専用のAITipsコンポーネントを使って専用のコンテナで記述する
  - 論文に明確に書かれていないために分からない事は、分からない旨と、何をすれば分かりそうか（どの参考文献に書かれていそうか等）をAI Tipsに書く
- セクション名や固有名詞は論文の英語をそのまま使用し、必要に応じて日本語訳を括弧書きで添える
- 参考文献の番号は論文中と同じ番号を使用する
- 参考文献ページでは論文の参考文献をカテゴリ別に整理して表示する

#### 3. データフロー

- 論文データは `/src/data/papers/` ディレクトリに JSON/JS モジュール形式で保存
- 各論文のメタデータや内容はここから読み込まれてページ生成に使用
- 図表データも同様に構造化されたデータとして管理され表示時に利用
- 各論文データは共通のインターフェースに従い、型安全性を確保

#### 4. ナビゲーション構造

- グローバルナビゲーション: 全ページ共通でアクセスできる, ホームページへのリンク
- セクションナビゲーション: 各論文でセクション間(解説ページ間)の移動を可能にする各セクションの直接リンク
- ページナビゲーション: 各論文でセクション間の移動を可能にする前後ページへの移動リンク

#### 5. レスポンシブ対応

- デスクトップ、タブレット、モバイルの3段階のレイアウト切り替え
- コンテンツファーストの設計で重要な情報を優先表示
- 画像・図表のモバイル表示最適化

### コンポーネント構成

```
/components
├── AITips.js (AIによる追加解説コンポーネント)
├── AlgorithmBlock.js (アルゴリズム表示ブロック)
├── ClientSearch.js (クライアントサイド検索機能)
├── ClientSidebar.js (クライアントサイド処理されるサイドバー)
├── ClientSideChart.js (クライアントサイドレンダリングチャート)
├── ComparisonCard.js (比較結果表示カード)
├── ExperimentPhaseCards.js (実験フェーズ表示カード)
├── ExperimentTable.js (実験結果表示テーブル)
├── GlobalNavigation.js (グローバルナビゲーション)
├── Layout.js (共通レイアウト)
├── MathEquation.js (数式レンダリング)
├── Navigation.js (ナビゲーション)
├── PageNavigation.js (ページナビゲーション)
├── PaperCard.js (論文カード)
├── PaperFigure.js (図表コンポーネント)
├── PaperHeader.js (論文ヘッダー情報)
├── ReferenceItem.js (参考文献アイテム)
├── ReferenceSection.js (参考文献セクション)
├── ResponsiveChart.js (レスポンシブ対応チャート)
├── ScrollToTop.js (トップへ戻るボタン)
├── SearchForm.js (検索フォーム)
├── SectionContainer.js (セクションコンテナ)
├── SectionHeader.js (セクションヘッダー)
├── Sidebar.js (サイドバー)
└── SubsectionContainer.js (サブセクションコンテナ)
```

## UI/UX設計

### ナビゲーション設計

- 固定ヘッダーにグローバルナビゲーションを配置
- 現在位置がわかるよう視覚的に強調
- モバイル表示時はハンバーガーメニューに切り替え
- 左サイドバーにセクションナビゲーション（目次）を表示
- 各ページの底にページナビゲーション（前後ページへの移動リンク）を表示
- スクロール位置に応じた目次の自動ハイライト

### ページレイアウト

#### ホームページのレイアウト

- ヘッダー: サイトタイトル、グローバルナビゲーション
- メインコンテンツ: 論文検索UI, 論文一覧ページへのリンク, 最近の論文解説ページ一覧
- ビジュアル要素: AIをテーマにした視覚的に魅力的なヒーローセクション

#### 論文一覧ページのレイアウト

- ヘッダー: サイトタイトル、グローバルナビゲーション
- メインコンテンツ: カテゴリ別の論文一覧
- フィルタリング機能: 論文のトピックやタグによるフィルタリング

#### 個別論文ページのレイアウト

- ヘッダー: サイトタイトル、グローバルナビゲーション、（モバイル表示時のみ）ハンバーガーメニュー
- メインコンテンツ（右）: 論文解説、図表、数式、AITips
- サイドバー（左）: 解説対象となる論文の情報（フルタイトル, 著者(多い場合は1st著者のみで, 後は省略していることを明記), 所属, 原論文のabstractページへのリンク）, セクションナビゲーション（目次）
- 右サイドバー: 現在セクション内の目次
- フッター: 著作権表示、githubのリポジトリへのリンク

### レスポンシブデザイン

- PC (1200px以上): 3カラムレイアウト（左サイドバー + メインコンテンツ + 右サイドバー）
- タブレット (768px～1199px): 2カラムレイアウト（メインコンテンツ + 右サイドバー）
- モバイル (767px以下): 1カラムレイアウト（メインコンテンツのみ）
- モバイル表示時のナビゲーション: スライドイン式サイドメニュー

### カラースキーム

- プライマリカラー: #3498db (青系) - AIを表現
  - プライマリライト: #e8f4fd - プライマリカラーの軽量版、背景やハイライトに使用
- セカンダリカラー: #2ecc71 (緑系) - 好奇心・探索を表現
  - セカンダリライト: #e8f8f1 - セカンダリカラーの軽量版、セクション背景などに使用
- アクセントカラー: #e74c3c (赤系) - 重要概念の強調に使用
  - アクセントライト: #fceae8 - アクセントカラーの軽量版、警告や重要ポイントの背景に使用
- AITips背景色: #f0e6ff (薄い紫) - AI特有の解説を視覚的に区別
- 背景色: #f5f5f5 (明るいグレー) - 読みやすさを確保
- テキスト色: #333333 (濃いグレー) - コントラストを確保

### タイポグラフィ

- 見出し: Roboto (sans-serif)
- 本文: Noto Sans JP (日本語対応フォント)
- コード: Source Code Pro (monospace)
- 数式: KaTeX標準フォント
- 行間: 1.6em (読みやすさを確保)
- 見出しの階層ごとのフォントサイズ比率: 1.5:1.3:1.15:1

## 機能設計

### コンテンツ表示機能

- セクション別ページ表示
- 数式の動的レンダリング (KaTeX使用)
  - インライン数式と独立した数式ブロックの両方をサポート
  - 数式番号の自動生成と参照機能
  - 複雑な数式も美しく表示するための最適化
- インタラクティブな図表表示
  - 静的な画像とインタラクティブなチャートの併用
  - データに基づく動的グラフ生成
  - ズーム・パン・ハイライト機能の実装
- アルゴリズム表示
  - 疑似コードの構造化表示
  - ステップごとの解説付き表示
- コードスニペット表示
  - シンタックスハイライト
  - コピー機能
- AITips表示
  - 論文にない追加情報を視覚的に区別して表示
  - 論文の内容と明確に区別できるデザイン
- セクション名や固有名詞は論文の英語のままとし、日本の中学生が理解できないような英語であれば括弧書きで日本語訳を付ける
- 専門用語のポップアップ解説（用語集連携）

### ナビゲーション機能

- スムーズスクロール
- パンくずリスト
- ヘッダーのグローバルナビゲーションのホームページへのリンク
- サイドバー目次から各セクションへのリンク、現在位置表示の自動更新
- 各ページの底にページナビゲーション（前後ページへの移動リンク）
- モバイル表示時はハンバーガーメニューに切り替え
- トップへ戻るボタン（一定以上スクロールした場合に表示）

### インタラクティブ機能

- 図表のズーム表示と詳細解説
- 実験結果の比較表示
- アルゴリズム実行の簡易デモ
- 論文参照のポップアップ表示
- 数式のインタラクティブ解説（ホバーで項の説明表示）
- 参考文献のカテゴリ切り替え
- カテゴリによるフィルタリング
- 参考文献のポップアッププレビュー

## 図表管理方針

### 図表のディレクトリ構造

論文解説サイトにおける図表は、以下のディレクトリ構造で管理します：

```
/public/images/papers/[paper-id]/
├── quoted/ （論文から直接引用した図表）
│   ├── fig1_architecture.svg （論文の図1: アーキテクチャ図）
│   ├── fig2_model.svg （論文の図2: モデル図）
│   └── ...
├── created/ （解説のために新たに作成した図表）
│   ├── overview.svg （概要説明用の図）
│   ├── algorithm_flow.svg （アルゴリズムのフロー図）
│   └── ...
└── assets/ （その他の画像リソース）
    ├── icons/
    ├── backgrounds/
    └── ...
```

### 図表の命名規則

1. **引用図表（`quoted/`ディレクトリ内）**

   - プレフィックスに `fig` と論文中の図番号を付ける（例: `fig1_`, `fig2_`）
   - アンダースコア後に図の内容を簡潔に表す英語名を付ける
   - 例: `fig1_architecture.svg`, `fig3_results.svg`

2. **作成図表（`created/`ディレクトリ内）**

   - 図の内容を簡潔に表す英語名をファイル名とする
   - 必要に応じて数字でバージョンや順序を表現する（例: `model_comparison_v2.svg`）
   - 例: `overview.svg`, `concept_explanation.svg`

3. **アセット（`assets/`ディレクトリ内）**
   - 用途に応じたサブディレクトリに分類して保存
   - 汎用的に使用される画像リソースを配置

### 図表の参照方法

コンポーネント内での図表参照は以下のパターンに従います：

```jsx
// 論文から引用した図の場合
<PaperFigure
  paper={paperData}  // 論文データオブジェクト
  figureId="architecture"  // 図表のID
  width={700}
  height={400}
  isQuoted={true}
/>

// 解説のために新たに作成した図の場合
<PaperFigure
  paper={paperData}  // 論文データオブジェクト
  figureId="concept-explanation"  // 図表のID
  width={700}
  height={400}
  isQuoted={false}
/>
```

`PaperFigure`コンポーネントは、`paper`オブジェクトと`figureId`を利用して図表の情報を取得します。
`isQuoted`プロパティによって、引用図表と作成図表を視覚的に区別して表示するため、読者は一目で情報の出所を識別できます。
図番号を表示したい場合は、`getFigNum(paperData, "figureId")`のようにオプションを指定します。

## 技術実装詳細

### Next.jsプロジェクト構成

```
/
├── public/ (静的ファイル)
│   ├── images/ (画像ファイル)
│   │   └── papers/ (論文ごとの図表)
│   │       └── [paper-id]/ (論文別ディレクトリ)
│   ├── fonts/ (フォントファイル)
│   └── favicon.ico
├── src/
│   ├── app/ (ページコンポーネント)
│   │   ├── layout.js
│   │   ├── page.js  (ホームページ)
│   │   └── papers/
│   │       ├── layout.js
│   │       ├── page.js (論文一覧ページ)
│   │       └── [paperId]/ (論文ごとのID)
│   │           ├── layout.js
│   │           ├── page.js (個別論文のトップページ)
│   │           ├── references/ (参考文献ページ)
│   │           │   └── page.js (カテゴリ別参考文献ページ)
│   │           └── [sectionNumber]_[sectionTitle]/ (セクション番号とタイトル. 番号がない場合はタイトルのみ)
│   ├── components/ (再利用可能コンポーネント)
│   │   ├── Layout.js
│   │   ├── Navigation.js
│   │   └── ...（上記コンポーネント一覧参照）
│   ├── styles/ (スタイル定義)
│   │   ├── globals.css
│   │   └── ...
│   ├── utils/ (ユーティリティ関数)
│   │   ├── chartUtils.js
│   │   └── ...
│   ├── data/ (コンテンツデータ)
│   │   ├── papers/
│   │   │   ├── index.js
│   │   │   ├── types.js
│   │   │   ├── _template.js (新規論文用テンプレート)
│   │   │   └── papers/
│   │   │       └── ...（各論文データ）
│   │   ├── references/ (参考文献データ)
│   │   │   ├── categories.js (カテゴリ定義)
│   │   │   └── [paperId].js (論文ごとの参考文献データ)
│   │   ├── glossary.js (用語集データ)
│   │   └── ...
│   ├── context/ (Reactコンテキスト)
│   │   └── LayoutContext.js (レイアウト状態管理)
│   └── scripts/ (ユーティリティスクリプト)
│       ├── check-links.js
│       ├── convert_a_to_link.js
│       ├── remove-dark-mode.js
│       └── ...
├── docs/ (ドキュメント)
│   ├── design/
│   │   └── design.md
│   └── requirements/
│       └── requirements.md
└── 設定ファイル
    ├── next.config.js
    ├── tailwind.config.js
    ├── postcss.config.js
    ├── jsconfig.json
    └── package.json
```

### データ構造例（参考文献）

```javascript
// categories.js
export const referenceCategories = [
  {
    id: 'algorithm',
    name: 'アルゴリズム',
    description: 'アルゴリズムに関する論文や書籍',
  },
  {
    id: 'model',
    name: 'モデル・手法',
    description: 'モデルや手法に関する論文',
  },
  // ...その他カテゴリ
];

// [paperId].js
export const references = [
  {
    id: 'ref1',
    citation: 'Author, A. (2020). Paper Title. Conference Name, pp. 100-110.',
    categories: ['algorithm', 'model'],
    importance: 5, // 1-5のスケール
    description: 'この論文はXYZアルゴリズムを提案し、ABCタスクで高い性能を示した。',
    doi: 'https://doi.org/10.xxxx/xxxxx',
    year: 2020,
  },
  // ...その他参考文献
];
```

### 記事の生成手順例

1. 論文を読み, 論文データのファイルと, 個別論文ページのセクションごとのフォルダを作成
2. 論文を読み, 論文に明確に書かれている事に沿って個別論文のトップページを作成
3. 論文を読み, 論文に明確に書かれている事に沿ってセクションごとのページを作成（セクションごとに論文を読むこととページ作成を繰り返す）
4. 論文を読み, 読者の理解を助けるためのAI Tipsを追加（理解を助けることを重視し, 論文に書かれていない事も書いて良い）
5. 論文を読み, 論文中の図のうち再現できるものの図をSVG形式で作成（ファイル名の頭に論文中の図番号を付けてもらう）
6. 論文を読み, 読者の理解を助けるための論文中に無い図をSVG形式で作成
7. 人間の目で見て品質が明らかに悪い図は削除し, 改善できそうなものは改善
8. 作成したSVG形式の図を, 個別論文ページで使用
9. 個別論文ページを人間の目で見て最終チェックする
